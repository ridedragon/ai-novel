# AI 小说写作助手 (AI Novel Writer)

这是一个基于 React + Vite + Tailwind CSS 开发的现代化 AI 辅助小说创作平台。它集成了灵感发散、世界观构建、角色管理、大纲规划和全自动写作的全流程创作工具，旨在通过深度模块化和 AI 协作提升创作效率。

> **隐私声明**：本项目为纯前端应用，您的 API Key 和创作内容仅存储在浏览器本地 (IndexedDB) 中，不会上传到任何第三方服务器。

---

## ✨ 核心功能

### 🏗️ 自动化创作中心 (Multi-Set Management)

项目采用“集合 (Set)”管理模式，支持为同一本小说创建多套设定并随时切换。每个模块都包含**生成模式**和**讨论模式**：

- **灵感集 (Inspiration)**: 捕捉创意碎片。支持与 AI 讨论灵感，并将讨论结果一键发送给主助手进行正文创作。
- **世界观 (Worldview)**: 构建宏大的世界背景。支持 AI 增量生成地理、魔法、社会规则等设定。
- **角色集 (Characters)**: 创建详细的角色档案。AI 可根据世界观背景辅助生成具有深度的人设。
- **故事大纲 (Outline)**: 规划章节结构。支持批量生成剧情摘要，并作为自动化写作的直接依据。

### 🔄 协同创作工作流 (Integrated Workflow)

本项目独创了“模块讨论 -> 主界面创作”的协同逻辑：

1. 在特定模块（如灵感或角色）中开启**聊天模式**，与 AI 深度探讨细节。
2. 点击聊天界面的**生成**按钮，系统会自动汇总讨论精华，将其作为指令发送给主界面的 AI 助手。
3. 主助手结合讨论背景，直接在正文编辑区开始高质量创作。

### ✍️ 智能写作与编辑增强

- **全自动批量写作**: 基于大纲和前文剧情，支持“断点续写”和“连续创作”模式，自动撰写整卷内容。
- **两阶段润色优化 (Two-Step Optimization)**:
  - **阶段 1 (分析)**: AI 犀利指出文章在节奏、描写、人物性格上的优缺点。
  - **阶段 2 (重写)**: 根据分析建议进行针对性润色，保留原文精髓的同时提升文笔。
- **长文模式 (Long Text Mode)**: 智能管理 Context Window，通过自动维护“摘要链”（大总结+小总结）突破 Token 限制，确保超长篇幅的连贯性。
- **正则脚本 (Regex Scripts)**: 支持自定义正则表达式脚本，对输入/输出文本进行自动化清洗、格式化或特定风格转换。
- **多版本管理**: 每个章节支持原文、多个优化版和编辑版切换，随时回溯创作历程。

### 📱 移动端深度适配

- **响应式 UI**: 完美适配手机浏览器操作，支持侧边栏折叠与手势交互。
- **后台防断连 (Keep-Alive)**: 提供静音音频保活功能，防止移动端浏览器在后台冻结 JavaScript 线程，保障长时间自动化写作不中断。
- **Termux 支持**: 支持在 Android 手机上通过 Termux 本地部署运行。

---

## 🚀 快速开始

### 电脑端运行

1. **环境要求**: Node.js (v18+)
2. **安装依赖**:

   ```bash
   npm install
   ```

3. **启动服务**:

   ```bash
   npm run dev
   ```

4. **访问**: `http://localhost:8002`

### 手机端运行 (Android)

请参考详细教程：[📱 手机 Termux 运行教程](手机Termux运行教程.md)

---

## 📖 使用指南

1. **配置 API**: 点击右上角 **设置** 图标，输入 OpenAI 格式的 API Key 和 Base URL。
2. **创建小说**: 在首页点击“创建新小说”，设定初始系统提示词。
3. **构建设定**: 进入 **自动化创作中心**，在“世界观”或“角色集”中点击“聊天”，与 AI 完善设定。
4. **发送创作**: 在模块聊天完成后，点击右下角蓝色的“生成”按钮，将讨论内容带回主界面。
5. **自动化写作**:
   - 在大纲页面点击“开始自动创作”。
   - 开启“长文模式”以获得更好的长篇连贯性。
   - 开启“自动优化”让 AI 在写完后自动进行润色。

---

## ⚙️ 高级配置

- **预设系统 (Presets)**: 针对大纲、角色、润色、聊天等不同场景，可独立配置 System Prompt、温度、Top P 等参数。
- **独立 API 配置**: 每个预设可单独配置 API 密钥和模型，方便使用不同模型（如 GPT-4 处理分析，廉价模型处理初稿）。
- **正则处理**: 点击顶部栏 `< >` 图标，配置正则脚本以自动处理 AI 输出中的多余空格或特定字符。

---

## 🛠️ 技术栈

- **核心框架**: React 18, TypeScript, Vite
- **样式方案**: Tailwind CSS, Lucide React (图标)
- **数据存储**: IndexedDB (通过 `idb-keyval` 管理)
- **AI 集成**: OpenAI SDK (支持流式输出)
- **文档解析**: React Markdown

---

*本项目旨在通过 AI 技术赋能创作者，让每个人都能更轻松地构建属于自己的文字世界。*
