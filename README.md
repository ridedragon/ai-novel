# AI 小说写作助手 (AI Novel Writer)

这是一个基于 React + Vite + Tailwind CSS 开发的现代化 AI 辅助小说创作平台。它不仅仅是一个简单的文本生成器，而是一个集成了灵感发散、世界观构建、角色管理、大纲规划和全自动写作的全流程创作工具。

> **隐私声明**：本项目为纯前端应用，您的 API Key 和创作内容仅存储在浏览器本地 (IndexedDB) 中，不会上传到任何第三方服务器。

---

## ✨ 核心功能

### 🏗️ 自动化创作中心 (Multi-Set Management)

项目采用“集合 (Set)”管理模式，支持为同一本小说创建多套设定并随时切换：

- **灵感集 (Inspiration)**: 捕捉稍纵即逝的创意，AI 辅助发散思维，生成结构化的灵感条目。
- **世界观 (Worldview)**: 构建宏大的世界背景，设定地理、魔法、社会规则等，支持 AI 增量生成。
- **角色集 (Characters)**: 创建详细的角色档案，设定性格、背景故事，支持 AI 根据世界观生成人设。
- **故事大纲 (Outline)**: 规划章节结构，自动生成剧情摘要，支持批量生成和上下文关联。

### ✍️ 智能写作与编辑增强

- **全自动批量写作**: 基于大纲和前文剧情，支持“断点续写”和“连续创作”模式，自动撰写整卷内容。
- **两阶段润色优化 (Two-Step Optimization)**:
  - **阶段 1 (分析)**: AI 犀利指出文章在节奏、描写、人物性格上的优缺点。
  - **阶段 2 (重写)**: 根据分析建议进行针对性润色，保留原文精髓的同时提升文笔。
- **长文模式 (Long Text Mode)**: 智能管理 Context Window，通过自动维护“摘要链”（大总结+小总结）突破 Token 限制，确保超长篇幅的连贯性。
- **正则脚本 (Regex Scripts)**: 支持自定义正则表达式脚本，对输入/输出文本进行自动化清洗、格式化或特定风格转换。
- **多版本管理**: 每个章节支持原文、优化版和编辑版切换，随时回溯创作历程。

### 📱 移动端深度适配

- **响应式 UI**: 完美适配手机浏览器操作。
- **后台防断连 (Keep-Alive)**: 提供静音音频保活功能，防止移动端浏览器在后台冻结 JavaScript 线程，保障长时间自动化写作不中断。
- **Termux 支持**: 支持在 Android 手机上通过 Termux 本地部署运行。

---

## 🚀 快速开始

### 电脑端运行

1. **环境要求**: Node.js (v18+)
2. **安装依赖**:

   ```bash
   npm install
   ```

3. **启动服务**:

   ```bash
   npm run dev
   ```

4. **访问**: `http://localhost:8002`

### 手机端运行 (Android)

请参考详细教程：[📱 手机 Termux 运行教程](手机Termux运行教程.md)

---

## 📖 使用指南

1. **配置 API**: 点击右上角 **设置** 图标，输入 OpenAI 格式的 API Key 和 Base URL。
2. **创建小说**: 在首页点击“创建新小说”，设定初始系统提示词。
3. **构建设定**: 进入 **自动化创作中心**，先在“世界观”和“角色集”中填充基础信息。
4. **规划大纲**: 在“故事大纲”模块生成章节规划，可勾选特定的角色集和世界观作为 AI 参考上下文。
5. **自动化写作**:
   - 在大纲页面点击“开始自动创作”。
   - 开启“长文模式”以获得更好的长篇连贯性。
   - 开启“自动优化”让 AI 在写完后自动进行润色。
6. **正则处理**: 点击顶部栏 `< >` 图标，配置正则脚本以自动处理 AI 输出中的多余空格或特定字符。

---

## ⚙️ 高级配置

- **预设系统 (Presets)**: 针对大纲、角色、润色等不同场景，可独立配置 System Prompt、温度、Top P 等参数。
- **独立 API 配置**: 每个预设可单独配置 API 密钥和模型，方便使用不同模型（如 GPT-4 处理分析，廉价模型处理初稿）。
- **摘要间隔**: 在全局设置中调整小总结和大总结的触发频率，优化长文模式的 Token 利用率。

---

## 🛠️ 技术栈

- **核心框架**: React 18, TypeScript, Vite
- **样式方案**: Tailwind CSS, Lucide React (图标)
- **数据存储**: IndexedDB (通过 `idb-keyval` 管理)
- **AI 集成**: OpenAI SDK (支持流式输出)
- **文档解析**: React Markdown

---

## 📄 开发者文档

- [项目逻辑与变量说明](变量和函数.md)
- [移动端保活方案设计](mobile_keepalive_plan.md)

---

*本项目旨在通过 AI 技术赋能创作者，让每个人都能更轻松地构建属于自己的文字世界。*
