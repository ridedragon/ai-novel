# Maliang AI Novel Writer - Agent 职责与协作总结 (更新版)

本文档根据最新的架构调整，重新定义了系统中 Agent 的核心职责。当前的架构已转向**“导演驱动 -> 程序执行”**模式，弱化了子 Agent 的独立性，强调流程的自动化衔接。

## 1. 核心 Agent 角色：导演 Agent (Director Agent)

导演 Agent 是系统的唯一核心大脑，负责全局规划与自动化流程的触发。

### 1.1 核心职责

- **任务规划**：
  - 分析用户宏观意图（如“写一个玄幻小说”）。
  - 生成 `AgentManifest` 任务清单，明确创作的流转顺序。
  - **注意**：导演 Agent 仅负责规划阶段性任务（如“生成世界观”），**不再负责编写章节的具体名称、内容或正文细节**。
- **流程控制（自动化触发）**：
  - 严格遵循渐进式创作原则：**灵感 -> 世界观 -> 粗纲 -> 角色集 -> 大纲 -> 正文**。
  - **自动基建**：直接触发程序创建对应的文件夹/设定集（灵感集、世界观集等）。
  - **衔接执行**：
    1. 自动将上一阶段生成的有效信息放入对应功能模块的 AI 输入框。
    2. 触发对应模块的“生成”按钮。
    3. 监听生成进度，完成后自动衔接至下一个流程环节。

### 1.2 运作逻辑

- **被动模式**：等待用户确认清单后逐项执行。
- **全自动模式 (Autopilot)**：从灵感种子开始，自动跨模块调用 UI 功能，直至生成最终的大纲与正文。

## 2. 被移除的角色 (Deprecated)

为了简化架构并提高程序执行的确定性，以下 Agent 角色已不再被需要：

- **创作 Agent (Writer Agent)**：其职能被分散到各个具体模块（灵感管理器、大纲管理器、写作界面）的内部 AI 处理逻辑中。
- **质检 Agent (Reviewer Agent)**：其逻辑由导演 Agent 的流程校验和程序的字数/格式硬性检查取代。

## 3. 自动化创作流转顺序

系统严格执行以下流水线，每个环节的输出将作为下一环节的输入：

1. **灵感 (Inspiration)**：生成核心创意、题材基调。
2. **世界观 (Worldview)**：基于灵感，构建地理、力量体系、势力等底层规则。
3. **粗纲 (Plot Outline)**：确定故事的主线脉络与重大转折。
4. **角色集 (Character Set)**：根据世界观与粗纲，定义核心角色的性格、动机与关系网。
5. **大纲 (Outline)**：将粗纲细化为章节级大纲，明确每一章的关键事件。
6. **正文 (Content)**：基于章节大纲与角色设定，由各章节编辑器执行最终写作。

## 4. 技术实现要点

- **UI 自动化映射**：导演 Agent 发出的 `ACTION` 指令不再是简单的文本生成，而是直接映射到 React 组件的 State 更新和 API 调用。
- **上下文传递**：程序负责在不同文件夹（设定集）之间传递 JSON 数据，确保信息的连贯性，减少 AI 在长文本中的记忆损耗。

---
*最后更新日期：2024年10月24日 (架构重定义版)*
